<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mockito Basic | MutsuGhost1's Blog</title>
  <meta name="author" content="MutsuGhost1">
  
  <meta name="description" content="Learning Mockito with examples

Verify some behavior (ignore any return value)
Verify some behavior with stubbing the return value
Verify unstubbing behavior
Argument matcher
Verify exact number of invocations
Verification in order
Finding redundant invocations
Stubbing consecutive calls
Stubbing with callbacks
doReturn()|doThrow()|doAnswer()|doNoting()|doCallRealMethod() family of methods
reset mock
Capturing Argument
Changing default return values of unstubbed invocations
Inject mock/spy object into tested target
Verify with timeout">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Mockito Basic"/>
  <meta property="og:site_name" content="MutsuGhost1's Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="MutsuGhost1's Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-44446906-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">MutsuGhost1's Blog</a></h1>
  <h2><a href="/">Pursue excellence, and success will follow, pants down</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/todolist">ToDo</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-18T00:48:44.000Z"><a href="/2014/05/18/learning-mockito/">5月 18 2014</a></time>
      
      
  
    <h1 class="title">Mockito Basic</h1>
  

    </header>
    <div class="entry">
      
        <ul>
<li><h2>Learning Mockito with examples</h2>
<ol>
<li><strong><a href="#1">Verify some behavior (ignore any return value)</a></strong></li>
<li><strong><a href="#2">Verify some behavior with stubbing the return value</a></strong></li>
<li><strong><a href="#3">Verify unstubbing behavior</a></strong></li>
<li><strong><a href="#4">Argument matcher</a></strong></li>
<li><strong><a href="#5">Verify exact number of invocations</a></strong></li>
<li><strong><a href="#6">Verification in order</a></strong></li>
<li><strong><a href="#7">Finding redundant invocations</a></strong></li>
<li><strong><a href="#8">Stubbing consecutive calls</a></strong></li>
<li><strong><a href="#9">Stubbing with callbacks</a></strong></li>
<li><strong><a href="#10">doReturn()|doThrow()|doAnswer()|doNoting()|doCallRealMethod() family of methods</a></strong></li>
<li><strong><a href="#11">reset mock</a></strong></li>
<li><strong><a href="#12">Capturing Argument</a></strong></li>
<li><strong><a href="#13">Changing default return values of unstubbed invocations</a></strong></li>
<li><strong><a href="#14">Inject mock/spy object into tested target</a></strong></li>
<li><strong><a href="#15">Verify with timeout</a></strong></li>
</ol>
</li>
</ul>
<h2><a id="more"></a></h2>
<ul>
<li><h2>Basic Concepts</h2>
<ul>
<li>撰寫 Unit Test 的 3A 原則:<ol>
<li>Arrange: <ul>
<li>Set up th object to be tested.</li>
<li>We may need to surround the object with collaborators. <br> For testing purposes, those collaborators minght be test objects (mocks, fakes, etc…) or the real ting.</li>
</ul>
</li>
<li>Act:<ul>
<li>Act on the object. (invoke the tested method with parameters.)</li>
</ul>
</li>
<li>Assert:<ul>
<li>Make claims about the object, its collaborators, its parameters and possibly global state.</li>
<li>In other words, verify the test result.</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<hr>
<p><a name=1></a></p>
<h3>verify somw behavior (ignore any return value)</h3>
<pre><code>@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test01(){

    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;)mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    <span class="comment">// Action on the object</span>
    mockedList<span class="variable">.add</span>(<span class="string">"one"</span>);
    mockedList<span class="variable">.clear</span>();

    <span class="comment">// Assert</span>
    <span class="comment">// Verify the result</span>
    verify(mockedList)<span class="variable">.add</span>(<span class="string">"one"</span>);
    verify(mockedList)<span class="variable">.clear</span>();

    <span class="comment">// Act</span>
    <span class="comment">// Action on the object</span>
    mockedList<span class="variable">.add</span>(<span class="string">"one"</span>);
    mockedList<span class="variable">.clear</span>();

    <span class="comment">// Assert</span>
    <span class="comment">// Verify the result.</span>
    <span class="comment">// The interactions should be accumulated unless the mock object is reset</span>
    verify(mockedList, times(<span class="number">2</span>))<span class="variable">.add</span>(<span class="string">"one"</span>);
    verify(mockedList, times(<span class="number">2</span>))<span class="variable">.clear</span>();
}</code></pre>
<hr>
<p><a name=2></a></p>
<h3>verify some behavior with stubbing the return value</h3>
<pre><code><span class="property">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)
public <span class="reserved">void</span> test02(){
    <span class="regexp">//</span> Arrange
    <span class="regexp">//</span> Create the mock object, it can be a concrete <span class="class"><span class="keyword">class</span>
    <span class="title">LinkedList</span>&lt;<span class="title">String</span>&gt; <span class="title">mockedList</span> = (<span class="title">LinkedList</span>&lt;<span class="title">String</span>&gt;) <span class="title">mock</span>(<span class="title">LinkedList</span>.<span class="title">class</span>);</span>

    <span class="regexp">//</span> Act
    <span class="regexp">//</span> Stubbing it.
    <span class="regexp">//</span> Make it <span class="keyword">return</span> what you want
    <span class="keyword">when</span>(mockedList.get(<span class="number">0</span>)).thenReturn(<span class="string">"first"</span>);
    <span class="regexp">//</span> The latter stubbing will override the former one
    <span class="keyword">when</span>(mockedList.get(<span class="number">0</span>)).thenReturn(<span class="string">"firstfirst"</span>);
    System.out.println(<span class="string">"test02:"</span> + mockedList.get(<span class="number">0</span>));
    System.out.println(<span class="string">"test02:"</span> + mockedList.get(<span class="number">0</span>));

    <span class="regexp">//</span> Assert
    verify(mockedList, times(<span class="number">2</span>)).get(<span class="number">0</span>);
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code><span class="tag">test02</span><span class="pseudo">:firstfirst</span>
<span class="tag">test02</span><span class="pseudo">:firstfirst</span></code></pre>
<hr>
<p><a name=3></a></p>
<h3>verify unstubbing behavior</h3>
<pre><code>@SuppressWarnings(<span class="string">"unchecked"</span>)
public void test03(){
    // Arrange
    // Create <span class="keyword">the</span> mock object, <span class="keyword">it</span> can be a concrete <span class="type">class</span>
    LinkedList&lt;String&gt; mockedList = (LinkedList&lt;String&gt;) mock(LinkedList.<span class="type">class</span>);

    // Act
    // The default <span class="constant">return</span> value <span class="keyword">for</span> object <span class="keyword">is</span> null.
    // For primitive type, <span class="keyword">the</span> default value <span class="keyword">for</span> int <span class="keyword">is</span> <span class="number">0.</span>
    //                   , <span class="keyword">the</span> default value <span class="keyword">for</span> <span class="type">boolean</span> <span class="keyword">is</span> <span class="constant">false</span>.
    System.out.println(<span class="string">"test03:"</span> + mockedList.<span class="keyword">get</span>(<span class="number">0</span>));

    // Assert
    // <span class="keyword">times</span>(<span class="number">1</span>) <span class="keyword">is</span> <span class="keyword">the</span> default value, <span class="keyword">if</span> you don't specify <span class="keyword">it</span>
    verify(mockedList, <span class="keyword">times</span>(<span class="number">1</span>)).<span class="keyword">get</span>(<span class="number">0</span>);
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code>test03:<span class="keyword">null</span></code></pre>
<hr>
<p><a name=4></a></p>
<h3>argument matching using default matcher</h3>
<pre><code><span class="comment">// Argument Matching Using Default Matcher</span>
@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test04(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);
    when(mockedList<span class="variable">.get</span>(anyInt()))<span class="variable">.thenReturn</span>(<span class="string">"stubbing string"</span>);

    <span class="comment">// Act</span>
    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span> ; i&lt;<span class="number">10</span>; i++){
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"["</span>+ i + <span class="string">"]:"</span> + mockedList<span class="variable">.get</span>(i));
    }

    <span class="comment">// Assert</span>
    verify(mockedList, times(<span class="number">10</span>))<span class="variable">.get</span>(anyInt());
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code><span class="attr_selector">[0]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[1]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[2]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[3]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[4]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[5]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[6]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[7]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[8]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span>
<span class="attr_selector">[9]</span><span class="pseudo">:stubbing</span> <span class="tag">string</span></code></pre>
<hr>
<h3>argument matching using customized matcher</h3>
<pre><code><span class="annotation">@SuppressWarnings</span>(<span class="string">"rawtypes"</span>)
<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">IsListOfTwoElements</span> <span class="keyword">extends</span> <span class="title">ArgumentMatcher</span>&lt;<span class="title">List</span>&gt;{</span>
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">boolean</span> matches(Object argument) {
        <span class="keyword">return</span> <span class="number">2</span> == ((List)argument).size();
    }

}

<span class="annotation">@SuppressWarnings</span>(<span class="string">"rawtypes"</span>)
<span class="keyword">private</span> List listOfTwoElements(){
    <span class="keyword">return</span> argThat(<span class="keyword">new</span> IsListOfTwoElements());
}

<span class="comment">// Argument Matching Using Custom Matcher</span>
<span class="annotation">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test05(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List.class);
    when(mockedList.addAll(listOfTwoElements())).thenReturn(<span class="keyword">true</span>);

    <span class="comment">// Act</span>
    mockedList.addAll(Arrays.asList(<span class="string">"one"</span>, <span class="string">"two"</span>));

    <span class="comment">// Assert</span>
    verify(mockedList).addAll(listOfTwoElements());
}</code></pre>
<hr>
<p><a name=5></a></p>
<h3>verify exact number of invocation</h3>
<pre><code>@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test06(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    mockedList<span class="variable">.add</span>(<span class="string">"one"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"two"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"two"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"three"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"three"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"three"</span>);

    <span class="comment">// Assert</span>
    verify(mockedList)<span class="variable">.add</span>(<span class="string">"one"</span>);
    verify(mockedList, times(<span class="number">1</span>))<span class="variable">.add</span>(<span class="string">"one"</span>);
    verify(mockedList, times(<span class="number">2</span>))<span class="variable">.add</span>(<span class="string">"two"</span>);
    verify(mockedList, times(<span class="number">3</span>))<span class="variable">.add</span>(<span class="string">"three"</span>);

    verify(mockedList, never())<span class="variable">.add</span>(<span class="string">"none"</span>);
    verify(mockedList, atLeastOnce())<span class="variable">.add</span>(<span class="string">"one"</span>);
    verify(mockedList, atLeast(<span class="number">2</span>))<span class="variable">.add</span>(<span class="string">"two"</span>);
    verify(mockedList, atMost(<span class="number">5</span>))<span class="variable">.add</span>(<span class="string">"three"</span>);
}</code></pre>
<hr>
<p><a name=6></a></p>
<h3>verification in order, using single mock</h3>
<pre><code><span class="keyword">public</span> <span class="keyword">void</span> test07(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; singleMock = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    singleMock<span class="variable">.add</span>(<span class="string">"one"</span>);
    singleMock<span class="variable">.add</span>(<span class="string">"two"</span>);

    <span class="comment">// Assert</span>
    InOrder inOrder = inOrder(singleMock);
    inOrder<span class="variable">.verify</span>(singleMock)<span class="variable">.add</span>(<span class="string">"one"</span>);
    inOrder<span class="variable">.verify</span>(singleMock)<span class="variable">.add</span>(<span class="string">"two"</span>);
}</code></pre>
<hr>
<h3>verification in order, using multiple mock</h3>
<pre><code>@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test08(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; firstMock = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);
    List&lt;String&gt; secondMock = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    firstMock<span class="variable">.add</span>(<span class="string">"one"</span>);
    secondMock<span class="variable">.add</span>(<span class="string">"two"</span>);
    firstMock<span class="variable">.add</span>(<span class="string">"three"</span>);
    secondMock<span class="variable">.add</span>(<span class="string">"four"</span>);

    <span class="comment">// Assert</span>
    <span class="comment">// Verification in order is flexible - you don't have to</span>
    <span class="comment">//   verify all interactions one-by-one but only those you're</span>
    <span class="comment">//   interested in testing in order</span>
    InOrder inOrder = inOrder(firstMock, secondMock);
    inOrder<span class="variable">.verify</span>(firstMock)<span class="variable">.add</span>(<span class="string">"one"</span>);
    inOrder<span class="variable">.verify</span>(secondMock)<span class="variable">.add</span>(<span class="string">"two"</span>);
    <span class="comment">// it still passes, even marks it as comment</span>
    inOrder<span class="variable">.verify</span>(firstMock)<span class="variable">.add</span>(<span class="string">"three"</span>);
    inOrder<span class="variable">.verify</span>(secondMock)<span class="variable">.add</span>(<span class="string">"four"</span>);
}</code></pre>
<hr>
<p><a name=7></a></p>
<h3>finding redundant invocations</h3>
<pre><code><span class="keyword">public</span> <span class="keyword">void</span> test09(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    mockedList<span class="variable">.add</span>(<span class="string">"one"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"two"</span>);

    <span class="comment">// Assert</span>
    verify(mockedList)<span class="variable">.add</span>(<span class="string">"one"</span>);
    verify(mockedList)<span class="variable">.add</span>(<span class="string">"two"</span>); <span class="comment">// mark it to fail</span>

    verifyNoMoreInteractions(mockedList);
}</code></pre>
<hr>
<p><a name=8></a></p>
<h3>stubbing consecutive calls (iterator-style stubbing)</h3>
<pre><code>@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test10(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    when(mockedList<span class="variable">.get</span>(<span class="number">0</span>))<span class="variable">.thenReturn</span>(<span class="string">"0"</span>)<span class="variable">.thenReturn</span>(<span class="string">"1"</span>);
    <span class="comment">// the usage above is equal to the below</span>
    <span class="comment">// when(mockedList.get(0)).thenReturn("0","1");</span>

    <span class="comment">// Assert</span>
    assertTrue(<span class="string">"0"</span><span class="variable">.equals</span>(mockedList<span class="variable">.get</span>(<span class="number">0</span>)));
    assertTrue(<span class="string">"1"</span><span class="variable">.equals</span>(mockedList<span class="variable">.get</span>(<span class="number">0</span>)));
}</code></pre>
<hr>
<p><a name=9></a></p>
<h3>stubbing with callbacks</h3>
<pre><code><span class="comment">// stubbing with callback</span>
<span class="comment">//   it can be used to simulate the response callback</span>
<span class="keyword">public</span> <span class="keyword">void</span> test11(){
    <span class="comment">// Arrange</span>
    Util mock = mock(Util<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    when(mock<span class="variable">.asyncCall</span>())<span class="variable">.thenAnswer</span>(new Answer(){
        @Override
        <span class="keyword">public</span> Object answer(InvocationOnMock invocation) throws Throwable {
            <span class="comment">// do the response call</span>
            System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test11: answer callback"</span>);
            <span class="keyword">return</span> Boolean<span class="variable">.valueOf</span>(<span class="literal">true</span>);
        }
    });

    <span class="comment">// Assert</span>
    assertTrue(mock<span class="variable">.asyncCall</span>());
    verify(mock)<span class="variable">.asyncCall</span>();
}</code></pre>
<hr>
<p><a name=10></a></p>
<h3>doReturn using mock</h3>
<pre><code><span class="comment">// doReturn using mock</span>
<span class="keyword">public</span> <span class="keyword">void</span> test12(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    <span class="comment">// When you use mock, it's equal to when(mockedList.get(0)).thenReturn("0")</span>
    doReturn(<span class="string">"one"</span>)<span class="variable">.when</span>(mockedList)<span class="variable">.get</span>(<span class="number">0</span>);
    <span class="comment">// when(mockedList.get(0)).thenReturn("0");</span>

    <span class="comment">// Assert</span>
    assertTrue(<span class="string">"one"</span><span class="variable">.equals</span>(mockedList<span class="variable">.get</span>(<span class="number">0</span>)));
    verify(mockedList)<span class="variable">.get</span>(<span class="number">0</span>);
}</code></pre>
<hr>
<h3>doReturn using spy</h3>
<pre><code><span class="comment">// doReturn using spy</span>
<span class="keyword">public</span> <span class="keyword">void</span> test13(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; spyList = (List&lt;String&gt;) spy(new LinkedList&lt;String&gt;());

    <span class="comment">// Act</span>
    <span class="comment">// When you use spy, it's not equal to when(spyList.get(0)).thenReturn("0")</span>
    doReturn(<span class="string">"one"</span>)<span class="variable">.when</span>(spyList)<span class="variable">.get</span>(<span class="number">0</span>);
    <span class="comment">// when(spyList.get(0)).thenReturn("0");</span>

    <span class="comment">// Assert</span>
    assertTrue(<span class="string">"one"</span><span class="variable">.equals</span>(spyList<span class="variable">.get</span>(<span class="number">0</span>)));
    verify(spyList)<span class="variable">.get</span>(<span class="number">0</span>);
}</code></pre>
<hr>
<h3>doThrow</h3>
<pre><code><span class="comment">// doThrow</span>
@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test14(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// it's equal to</span>
    <span class="comment">// doThrow(new RuntimeException()).when(mockedList).toString();</span>
    doThrow(RuntimeException<span class="variable">.class</span>)<span class="variable">.when</span>(mockedList)<span class="variable">.toString</span>();

    <span class="keyword">try</span>{
        System<span class="variable">.out</span><span class="variable">.println</span>(mockedList);
    }<span class="keyword">catch</span>(RuntimeException e){
        <span class="comment">/// pass</span>
    }
}</code></pre>
<hr>
<h3>doAnswer</h3>
<pre><code><span class="comment">// rewrite case 10 using doAnswer</span>
@SuppressWarnings(<span class="string">"rawtypes"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test15(){
    <span class="comment">// Arrange</span>
    Util mock = mock(Util<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    doAnswer(new Answer(){
        @Override
        <span class="keyword">public</span> Object answer(InvocationOnMock invocation) throws Throwable {
            <span class="comment">// do the response call</span>
            System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test15: answer callback"</span>);
            <span class="keyword">return</span> Boolean<span class="variable">.valueOf</span>(<span class="literal">true</span>);
        }
    })<span class="variable">.when</span>(mock)<span class="variable">.asyncCall</span>();

    <span class="comment">// Assert</span>
    assertTrue(mock<span class="variable">.asyncCall</span>());
    verify(mock)<span class="variable">.asyncCall</span>();
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code><span class="attribute">test15</span>: <span class="string">answer callback</span>
<span class="attribute">test15</span>: <span class="string">answer callback</span></code></pre>
<hr>
<h3>doNothing</h3>
<pre><code><span class="comment">// doNothing</span>
<span class="comment">// it's rarely to use doNothing, the following is an example</span>
@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test16(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);
    doNothing()<span class="variable">.doThrow</span>(new RuntimeException())<span class="variable">.when</span>(mockedList)<span class="variable">.clear</span>();

    <span class="comment">// Act</span>
    <span class="comment">// does nothing the first time:</span>
    mockedList<span class="variable">.clear</span>();

    <span class="keyword">try</span>{
        <span class="comment">// throws RuntimeException the next time:</span>
        mockedList<span class="variable">.clear</span>();
    }<span class="keyword">catch</span>(RuntimeException e){

    }
}</code></pre>
<hr>
<h3>doRealCall</h3>
<pre><code><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="id">Util2</span>{</span>
    <span class="keyword">public</span> String A(){
        <span class="keyword">return</span> <span class="string">"A"</span>;
    }

    <span class="keyword">private</span> String B(){
        <span class="keyword">return</span> <span class="string">"B"</span>;
    }

    <span class="keyword">public</span> String AB(){
        <span class="keyword">return</span> A() + B();
    }
}

<span class="comment">// doRealCall</span>
<span class="comment">// mock object can also be used to do partial mock</span>
<span class="keyword">public</span> <span class="keyword">void</span> test17(){
    Util2 mockUtil2 = mock(Util2<span class="variable">.class</span>);
    assertTrue(null == mockUtil2<span class="variable">.A</span>());

    when(mockUtil2<span class="variable">.A</span>())<span class="variable">.thenCallRealMethod</span>();
    assertTrue(<span class="string">"A"</span><span class="variable">.equals</span>(mockUtil2<span class="variable">.A</span>()));

    <span class="comment">// mark any one to fail</span>
    when(mockUtil2<span class="variable">.B</span>())<span class="variable">.thenCallRealMethod</span>();
    when(mockUtil2<span class="variable">.AB</span>())<span class="variable">.thenCallRealMethod</span>();
    assertTrue(<span class="string">"AB"</span><span class="variable">.equals</span>(mockUtil2<span class="variable">.AB</span>()));
}</code></pre>
<hr>
<p><a name=11></a></p>
<h3>reset mock</h3>
<pre><code><span class="comment">// reset mock</span>
@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test18(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List.<span class="keyword">class</span>);

    <span class="comment">// Act</span>
    mockedList.<span class="keyword">get</span>(<span class="number">0</span>);
    reset(mockedList);

    <span class="comment">// Assert</span>
    verify(mockedList, never()).<span class="keyword">get</span>(<span class="number">0</span>);
}</code></pre>
<hr>
<p><a name=12></a></p>
<h3>capturing arguments</h3>
<pre><code><span class="comment">// capturing arguments for further assertions</span>
@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test19(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);
    ArgumentCaptor&lt;String&gt; argument = ArgumentCaptor<span class="variable">.forClass</span>(String<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    mockedList<span class="variable">.add</span>(<span class="string">"Hello World"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"two"</span>);
    mockedList<span class="variable">.add</span>(<span class="string">"three"</span>);

    <span class="comment">// Assert</span>
    verify(mockedList, times(<span class="number">3</span>))<span class="variable">.add</span>(argument<span class="variable">.capture</span>());

    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test19:"</span> + argument<span class="variable">.getAllValues</span>());
    <span class="comment">// print the argument of last call</span>
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test19:"</span> + argument<span class="variable">.getValue</span>());
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code><span class="tag">test19</span>:<span class="attr_selector">[Hello World, two, three]</span>
<span class="tag">test19</span><span class="pseudo">:three</span></code></pre>
<hr>
<p><a name=13></a></p>
<h3>change the default value of unstubbed invocations (using RETURNS_SMART_NULLS)</h3>
<pre><code><span class="comment">// change the default value of unstubbed invocations</span>
<span class="comment">//   use RETURNS_SMART_NULLS to know which null pointer exception</span>
<span class="comment">//   is caused by unstubing</span>
@SuppressWarnings(<span class="string">"rawtypes"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test20(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    List mockedList =  mock(List<span class="variable">.class</span>, RETURNS_SMART_NULLS);
    ListIterator iterator = mockedList<span class="variable">.listIterator</span>();

    <span class="keyword">try</span>{
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test20:"</span> + iterator<span class="variable">.nextIndex</span>());
    }<span class="keyword">catch</span>(SmartNullPointerException e){

    }
}</code></pre>
<hr>
<h3>change the default value of unstubbed invocations (using CALLS_REAL_METHODS)</h3>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="id">PartialMockObject</span> {</span>
    <span class="keyword">public</span> String m1(){
        <span class="keyword">return</span> <span class="string">"PartialMockObject:"</span> + <span class="string">"m1"</span>;
    }

    <span class="keyword">public</span> String m2(){
        <span class="keyword">return</span> p() + <span class="string">"m3"</span>;
    }

    <span class="keyword">public</span> String m3(){
        <span class="keyword">return</span> pp() + <span class="string">"m3"</span>;
    }

    <span class="keyword">public</span> String p(){
        <span class="keyword">return</span> <span class="string">"PartialMockObject:"</span>;
    }

    <span class="keyword">private</span> String pp(){
        <span class="keyword">return</span> p();
    }
}

<span class="comment">// change the default value of unstubbed invocations</span>
<span class="comment">//   use CALLS_REAL_METHODS to simulate partial mock</span>
<span class="keyword">public</span> <span class="keyword">void</span> test24(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    PartialMockObject mock =  mock(PartialMockObject<span class="variable">.class</span>, CALLS_REAL_METHODS);
    PartialMockObject spy = spy(new PartialMockObject());

    when(mock<span class="variable">.m3</span>())<span class="variable">.thenReturn</span>(<span class="string">"m3 is stubbed"</span>);
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test24: mock.m1()="</span> + mock<span class="variable">.m1</span>());
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test24: mock.m2()="</span> + mock<span class="variable">.m2</span>());
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test24: mock.m3()="</span> + mock<span class="variable">.m3</span>());

    when(spy<span class="variable">.m3</span>())<span class="variable">.thenReturn</span>(<span class="string">"m3 is stubbed"</span>);
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test24: spy.m1()="</span> + spy<span class="variable">.m1</span>());
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test24: spy.m2()="</span> + spy<span class="variable">.m2</span>());
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test24: spy.m3()="</span> + spy<span class="variable">.m3</span>());
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code><span class="attribute">test24</span>: <span class="string">mock.m1()=PartialMockObject:m1</span>
<span class="attribute">test24</span>: <span class="string">mock.m2()=PartialMockObject:m3</span>
<span class="attribute">test24</span>: <span class="string">mock.m3()=m3 is stubbed</span>
<span class="attribute">test24</span>: <span class="string">spy.m1()=PartialMockObject:m1</span>
<span class="attribute">test24</span>: <span class="string">spy.m2()=PartialMockObject:m3</span>
<span class="attribute">test24</span>: <span class="string">spy.m3()=m3 is stubbed</span></code></pre>
<hr>
<p><a name=14></a></p>
<h3>inject mock/spy into tested target (using constructor)</h3>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="id">SUT</span> {</span>
    List&lt;String&gt; mList;

    <span class="keyword">public</span> SUT(List&lt;String&gt; list){
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT's constructor"</span>);
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT's mList:"</span> + mList);
        mList = list;
    }

    <span class="keyword">public</span> String get(<span class="keyword">int</span> index){
        <span class="keyword">return</span> mList<span class="variable">.get</span>(index);
    }

    <span class="keyword">public</span> boolean put(String obj){
        <span class="keyword">return</span> mList<span class="variable">.add</span>(obj);
    }

    @Override
    <span class="keyword">public</span> boolean equals(Object obj) {
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT'equals: (SUT)obj).mList ="</span> + ((SUT)obj)<span class="variable">.mList</span>);
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT'equals: mList ="</span> + mList);
        <span class="keyword">return</span> ((SUT)obj)<span class="variable">.mList</span> == mList;
    }
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code>test21: start
SUT<span class="string">'s constructor
SUT'</span>s mList:null
SUT2<span class="string">'s constructor
SUT3'</span>s <span class="function"><span class="keyword">constructor</span>
<span class="title">SUT</span>'<span class="title">s</span> <span class="title">constructor</span>
<span class="title">SUT</span>'<span class="title">s</span> <span class="title">mList</span>:</span>null
SUT<span class="string">'equals: (SUT)obj).mList =mList
SUT'</span>equals: mList =mList
test21: <span class="keyword">end</span></code></pre>
<hr>
<h3>inject mock/spy into tested target (using setter)</h3>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="id">SUT2</span> {</span>
    List&lt;String&gt; mList2;

    <span class="keyword">public</span> SUT2(){
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT2's constructor"</span>);
    }

    <span class="keyword">public</span> String get(<span class="keyword">int</span> index){
        <span class="keyword">return</span> mList2<span class="variable">.get</span>(index);
    }

    <span class="keyword">public</span> boolean put(String obj){
        <span class="keyword">return</span> mList2<span class="variable">.add</span>(obj);
    }

    <span class="keyword">public</span> <span class="keyword">void</span> setList(List&lt;String&gt; list){
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT2's setList"</span>);
        mList2 = list;
    }
    @Override
    <span class="keyword">public</span> boolean equals(Object obj) {
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT2's equals: (SUT2)obj).mList2 ="</span> + ((SUT2)obj)<span class="variable">.mList2</span>);
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT2's equals: mList2 ="</span> + mList2);
        <span class="keyword">return</span> ((SUT2)obj)<span class="variable">.mList2</span> == mList2;
    }
}

<span class="comment">// dependency injection using the setter</span>
@Mock <span class="keyword">private</span> List&lt;String&gt; mList2;
@InjectMocks <span class="keyword">private</span> SUT2 mSUT2;
<span class="keyword">public</span> <span class="keyword">void</span> test22(){
    <span class="comment">// Arrange</span>
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test22: start"</span>);
    MockitoAnnotations<span class="variable">.initMocks</span>(<span class="keyword">this</span>);
    <span class="comment">// Act</span>
    <span class="comment">// Assert</span>
    assertNotNull(mList2);
    assertNotNull(mSUT2);

    SUT2 sut2 = new SUT2();
    sut2<span class="variable">.setList</span>(mList2);
    assertTrue(mSUT2<span class="variable">.equals</span>(sut2));
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test22: end"</span>);
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code>test22: start
SUT<span class="string">'s constructor
SUT'</span>s mList:null
SUT2<span class="string">'s constructor
SUT3'</span>s <span class="function"><span class="keyword">constructor</span>
<span class="title">SUT2</span>'<span class="title">s</span> <span class="title">constructor</span>
<span class="title">SUT2</span>'<span class="title">s</span> <span class="title">setList</span>
<span class="title">SUT2</span>'<span class="title">s</span> <span class="title">equals</span>:</span> (SUT2)obj).mList2 =mList2
SUT2<span class="string">'s equals: mList2 =mList2
test22: end</code></pre>
<hr>
<h3>inject mock/spy into tested target (using field)</h3>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="id">SUT3</span> {</span>
    List&lt;String&gt; mList3;

    <span class="keyword">public</span> SUT3(){
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT3's constructor"</span>);
    }

    <span class="keyword">public</span> String get(<span class="keyword">int</span> index){
        <span class="keyword">return</span> mList3<span class="variable">.get</span>(index);
    }

    <span class="keyword">public</span> boolean put(String obj){
        <span class="keyword">return</span> mList3<span class="variable">.add</span>(obj);
    }
    @Override
    <span class="keyword">public</span> boolean equals(Object obj) {
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT3's equals: (SUT3)obj).mList3 ="</span> + ((SUT3)obj)<span class="variable">.mList3</span>);
        System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"SUT3's equals: mList3 ="</span> + mList3);
        <span class="keyword">return</span> ((SUT3)obj)<span class="variable">.mList3</span> == mList3;
    }
}

<span class="comment">// dependency injection using field</span>
@Mock(name=<span class="string">"mList3"</span>) <span class="keyword">private</span> List&lt;String&gt; mLIST3;
@InjectMocks <span class="keyword">private</span> SUT3 mSUT3;
<span class="keyword">public</span> <span class="keyword">void</span> test23(){
    <span class="comment">// Arrange</span>
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test23: start"</span>);
    MockitoAnnotations<span class="variable">.initMocks</span>(<span class="keyword">this</span>);
    <span class="comment">// Act</span>
    <span class="comment">// Assert</span>
    assertNotNull(mLIST3);
    assertNotNull(mSUT3);

    SUT3 sut3 = new SUT3();
    sut3<span class="variable">.mList3</span> = mLIST3;
    assertTrue(mSUT3<span class="variable">.equals</span>(sut3));
    System<span class="variable">.out</span><span class="variable">.println</span>(<span class="string">"test23: end"</span>);
}</code></pre>
<p><strong>Output:</strong></p>
<pre><code>test23: start
SUT<span class="string">'s constructor
SUT'</span>s mList:null
SUT2<span class="string">'s constructor
SUT3'</span>s <span class="function"><span class="keyword">constructor</span>
<span class="title">SUT3</span>'<span class="title">s</span> <span class="title">constructor</span>
<span class="title">SUT3</span>'<span class="title">s</span> <span class="title">equals</span>:</span> (SUT3)obj).mList3 =mList3
SUT3<span class="string">'s equals: mList3 =mList3
test23: end</code></pre>
<hr>
<p><a name=15></a></p>
<h3>verify with timeout</h3>
<pre><code>@SuppressWarnings(<span class="string">"unchecked"</span>)
<span class="keyword">public</span> <span class="keyword">void</span> test25(){
    <span class="comment">// Arrange</span>
    <span class="comment">// Create the mock object, even it's an interface</span>
    final List&lt;String&gt; mockedList = (List&lt;String&gt;) mock(List<span class="variable">.class</span>);

    <span class="comment">// Act</span>
    <span class="comment">// When you use mock, it's equal to when(mockedList.get(0)).thenReturn("0")</span>
    Thread t1 = new Thread(new Runnable() {
        @Override
        <span class="keyword">public</span> <span class="keyword">void</span> run() {
            <span class="keyword">try</span>{
                Thread<span class="variable">.sleep</span>(<span class="number">2500</span>);
                <span class="comment">// when(mockedList.get(0)).thenReturn("0");</span>
                doReturn(<span class="string">"one"</span>)<span class="variable">.when</span>(mockedList)<span class="variable">.get</span>(<span class="number">0</span>);
                assertTrue(<span class="string">"one"</span><span class="variable">.equals</span>(mockedList<span class="variable">.get</span>(<span class="number">0</span>)));
            } <span class="keyword">catch</span>(InterruptedException e){

            }
        }
    });
    t1<span class="variable">.start</span>();

    <span class="comment">// Assert</span>
    <span class="keyword">long</span> start, <span class="keyword">end</span>, elapsed;
    start = System<span class="variable">.currentTimeMillis</span>();
    <span class="comment">// if the condition is satisfied, it won't be blocked</span>
    verify(mockedList, timeout(<span class="number">3000</span>))<span class="variable">.get</span>(<span class="number">0</span>);
    <span class="keyword">end</span> = System<span class="variable">.currentTimeMillis</span>();
    elapsed = <span class="keyword">end</span> - start;
    assertTrue(elapsed &gt; <span class="number">2000</span>);
}</code></pre>
<hr>
<ul>
<li>[Reference]<ul>
<li>[1] <a href="http://code.google.com/p/mockito/" target="_blank">Mockito Official Website</a></li>
<li>[2] <a href="http://msdn.microsoft.com/zh-tw/library/dn167673.aspx" target="_blank">30天快速上手TDD</a></li>
</ul>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/Software Testing/">Software Testing</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:mutsughost1.github.io/">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分類</h3>
  <ul class="entry">
  
    <li><a href="/categories/Software/">Software</a><small>4</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">標籤</h3>
  <ul class="entry">
  
    <li><a href="/tags/Blog/">Blog</a><small>1</small></li>
  
    <li><a href="/tags/Python/">Python</a><small>3</small></li>
  
    <li><a href="/tags/Software Testing/">Software Testing</a><small>1</small></li>
  
    <li><a href="/tags/Study Group/">Study Group</a><small>3</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2014/05/18/learning-mockito/">Mockito Basic</a>
      </li>
    
      <li>
        <a href="/2013/09/29/python-basic/">Python Basic</a>
      </li>
    
      <li>
        <a href="/2013/09/29/about-this-blog/">About This Blog</a>
      </li>
    
      <li>
        <a href="/2013/09/27/python-oop-exception/">Python OOP Exception</a>
      </li>
    
      <li>
        <a href="/2013/09/27/python-module-package/">Python Module Package</a>
      </li>
    
  </ul>
</div>


  <div class="widget tag">
  <h3 class="title">最新留言</h3>
  <ul class="entry">
  <script type="text/javascript" src="http://mutsughost1.disqus.com/recent_comments_widget.js?num_items=5&hide_avatars=0&avatar_size=32&excerpt_length=200&hide_mods=0"></script>
  </ul>
</div>


  <div class="widget tag">
  <h3 class="title">喃喃自語</h3>
  <ul class="entry">
  <a class="twitter-timeline" height="250" href="https://twitter.com/MutsuGhost1" data-widget-id="384199658408402944">@MutsuGhost1������</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
</div>


</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 MutsuGhost1
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'mutsughost1';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>